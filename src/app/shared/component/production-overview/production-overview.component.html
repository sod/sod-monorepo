<ng-container *ngIf="{edit: edit$ | async} as state">
    <nz-card
        [nzTitle]="production | productionTitle"
        nzSize="small"
        class="mb-3"
        [class.shadow]="state.edit?.index === production.index"
        [nzExtra]="extraTemplate"
    >
        <div *ngIf="production.recipe.inputs.length">
            <div>
                <app-satisfactory-item-image
                    [itemPackage]="value"
                    *ngFor="let value of production.recipe.inputs"
                ></app-satisfactory-item-image>
            </div>

            Inputs:
            <ul>
                <li *ngFor="let value of production.recipe.inputs">{{ value | amountWithModifiers }}x {{ value.itemName }}</li>
            </ul>
        </div>
        <div *ngIf="production.recipe.outputs.length">
            <div class="float-right">
                <app-satisfactory-item-image
                    [itemPackage]="value"
                    *ngFor="let value of production.recipe.outputs"
                ></app-satisfactory-item-image>
            </div>

            Outputs:
            <ul>
                <li *ngFor="let value of production.recipe.outputs">{{ value | amountWithModifiers }}x {{ value.itemName }}</li>
            </ul>
        </div>
    </nz-card>

    <ng-template #extraTemplate>
        <button
            nz-button
            [nzType]="state.edit && production.index === state.edit.index ? 'primary' : 'link'"
            (click)="edit(production.index)"
        >
            <i nz-icon nzType="edit" nzTheme="outline"></i>
            Edit
        </button>
    </ng-template>
</ng-container>
